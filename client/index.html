<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TODAY'S STOCK | Stock Search</title>
    <meta name="description" content="코스피, 코스닥 종목을 검색하고 주가 및 이동평균선 정보를 확인하세요.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300..700&family=Noto+Sans+KR:wght@300..700&display=swap"
        rel="stylesheet">
    <link href="https://webfontworld.github.io/gmarket/GmarketSans.css" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <link rel="stylesheet" href="/static/style.css">
</head>

<body>
    <!-- Cinematic CSS Background -->
    <div class="bg-cinematic">
        <div class="bg-grid"></div>
        <div class="bg-flare flare-1"></div>
        <div class="bg-flare flare-2"></div>
        <div class="bg-flare flare-3"></div>
        <div class="bg-data-stream stream-1"></div>
        <div class="bg-data-stream stream-2"></div>
        <div class="bg-data-stream stream-3"></div>
        <div class="bg-overlay"></div>
    </div>

    <div class="app-layout">
        <!-- Sidebar Hamburger Toggle (visible when unpinned) -->
        <button id="sidebarToggle" class="sidebar-toggle" aria-label="관심종목 열기" title="관심종목">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                stroke-linecap="round" stroke-linejoin="round">
                <line x1="3" y1="6" x2="21" y2="6"></line>
                <line x1="3" y1="12" x2="21" y2="12"></line>
                <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
        </button>

        <!-- Sidebar Overlay (for mobile/unpinned click-away) -->
        <div id="sidebarOverlay" class="sidebar-overlay"></div>

        <!-- Watchlist Sidebar -->
        <aside id="watchlistSidebar" class="watchlist-sidebar">
            <div class="sidebar-header">
                <h2 class="sidebar-title"><i class="ph ph-list-checks"></i> 관심종목</h2>
                <div class="sidebar-header-actions">
                    <span id="watchlistCount" class="sidebar-count">0</span>
                    <button id="sidebarPinBtn" class="sidebar-pin-btn" title="사이드바 고정" aria-label="사이드바 고정">
                        <svg class="pin-icon" width="16" height="16" viewBox="0 0 24 24" fill="none"
                            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 17v5"></path>
                            <path
                                d="M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1z">
                            </path>
                        </svg>
                    </button>
                </div>
            </div>
            <div id="watchlistItems" class="watchlist-items"></div>
            <div id="watchlistEmpty" class="watchlist-empty">
                <span class="empty-icon"><i class="ph ph-push-pin"></i></span>
                <p>종목을 검색하고<br>"종목추가" 버튼으로<br>관심 목록에 추가하세요</p>
            </div>
            <div class="sidebar-footer" id="sidebarFooter">
                <button id="sidebarLogoutBtn" class="sidebar-logout-btn" aria-label="로그아웃" title="로그아웃">
                    <span class="logout-icon">로그아웃</span>
                </button>
            </div>
        </aside>

        <div class="container">
            <!-- Header -->
            <header class="header">
                <div class="header-row">
                    <div class="header-left">
                        <!-- Navigation or other icons can go here if needed -->
                    </div>
                    <div class="logo-placeholder"></div>
                    <div class="header-actions">
                        <button id="authBtn" class="auth-btn">
                            <span class="auth-icon"><i class="ph ph-user"></i></span> 로그인
                        </button>
                    </div>
                </div>
                <p class="subtitle">코스피 · 코스닥 종목 검색</p>
            </header>

            <!-- Search Section -->
            <section class="search-section">
                <!-- Unified Center Logo -->
                <div class="unified-logo-container">
                    <div class="unified-logo-icon">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" class="primary-logo-svg"
                            xmlns="http://www.w3.org/2000/svg">
                            <!-- Chart Line Background -->
                            <path d="M3 17L8 10L12 13L18 3" stroke="#006eb8" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round" opacity="0.6" />
                            <!-- Magnifying Glass -->
                            <circle cx="14" cy="11" r="7" stroke="url(#logoGradient)" stroke-width="2.5"
                                stroke-linecap="round" stroke-linejoin="round" />
                            <path d="M19 16L22.5 19.5" stroke="url(#logoGradient)" stroke-width="2.5"
                                stroke-linecap="round" stroke-linejoin="round" />
                            <!-- Crosshair / Inspection Focus Point -->
                            <circle cx="14" cy="11" r="1.5" fill="#02e079" />
                            <defs>
                                <linearGradient id="logoGradient" x1="7" y1="4" x2="21" y2="18"
                                    gradientUnits="userSpaceOnUse">
                                    <stop offset="0%" stop-color="#02e079" />
                                    <stop offset="100%" stop-color="#0096ff" />
                                </linearGradient>
                            </defs>
                        </svg>
                    </div>
                    <h1 class="unified-logo-text">TODAY's STOCK</h1>
                </div>
                <p class="search-guide">종목명 또는 종목번호(6자리)로 검색할 수 있습니다</p>
                <div class="search-wrapper">
                    <div class="search-icon">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="11" cy="11" r="8"></circle>
                            <path d="m21 21-4.3-4.3"></path>
                        </svg>
                    </div>
                    <input type="text" id="searchInput" class="search-input"
                        placeholder="종목명 또는 종목코드를 입력하세요 (예: 삼성전자, 005930)" autocomplete="off" spellcheck="false">
                    <div class="search-shortcut">
                        <kbd>검색</kbd>
                    </div>
                    <button id="addWatchlistBtn" class="add-watchlist-btn" disabled title="종목을 먼저 검색하세요">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        추가
                    </button>
                </div>
                <!-- Autocomplete Dropdown -->
                <div id="suggestDropdown" class="suggest-dropdown hidden"></div>
                <!-- Recent Searches -->
                <div id="recentSearches" class="recent-searches hidden">
                    <div class="recent-header">
                        <span class="recent-label"><i class="ph ph-clock-counter-clockwise"></i> 최근 검색</span>
                        <button id="clearRecent" class="recent-clear">전체 삭제</button>
                    </div>
                    <div id="recentList" class="recent-list"></div>
                </div>
            </section>

            <!-- Loading -->
            <div id="loadingSpinner" class="loading hidden">
                <div class="spinner"></div>
                <p>주가 데이터를 가져오는 중...</p>
            </div>

            <!-- Error Message -->
            <div id="errorMessage" class="error-message hidden"></div>

            <!-- Results -->
            <section id="resultSection" class="result-section hidden">
                <!-- Stock Header Card -->
                <div class="stock-header-card">
                    <div class="stock-title-row">
                        <div class="stock-name-group">
                            <span id="stockMarketBadge" class="market-badge">KOSPI</span>
                            <span id="stockIndustry" class="industry-badge"></span>
                            <h2 id="stockName" class="stock-name">삼성전자</h2>
                            <span id="stockCode" class="stock-code">005930</span>
                        </div>
                        <div id="stockDate" class="stock-date"></div>
                    </div>
                    <div id="stockSummary" class="stock-summary-container"></div>
                    <div class="price-row">
                        <span id="stockPrice" class="current-price">0</span>
                        <span id="stockChange" class="price-change">0 (0.00%)</span>
                    </div>
                    <div class="ohlv-row">
                        <div class="ohlv-item">
                            <span class="ohlv-label">시가</span>
                            <span id="stockOpen" class="ohlv-value">0</span>
                        </div>
                        <div class="ohlv-item">
                            <span class="ohlv-label">고가</span>
                            <span id="stockHigh" class="ohlv-value">0</span>
                        </div>
                        <div class="ohlv-item">
                            <span class="ohlv-label">저가</span>
                            <span id="stockLow" class="ohlv-value">0</span>
                        </div>
                        <div class="ohlv-item">
                            <span class="ohlv-label">거래량</span>
                            <span id="stockVolume" class="ohlv-value">0</span>
                        </div>
                    </div>
                </div>

                <!-- NXT 시간외 거래 카드 -->
                <div id="nxtCard" class="nxt-card hidden">
                    <div class="nxt-header">
                        <div class="nxt-title-row">
                            <span class="nxt-badge">NXT</span>
                            <h3 class="nxt-title">시간외 거래</h3>
                            <span id="nxtStatus" class="nxt-status"></span>
                        </div>
                        <span id="nxtTime" class="nxt-time"></span>
                    </div>
                    <div class="nxt-body">
                        <div class="nxt-price-row">
                            <span id="nxtPrice" class="nxt-price">0</span>
                            <span id="nxtChange" class="nxt-change">0원 (0%)</span>
                        </div>
                        <div class="nxt-detail">
                            <div class="nxt-detail-item">
                                <span class="nxt-detail-label">고가</span>
                                <span id="nxtHigh" class="nxt-detail-value">0</span>
                            </div>
                            <div class="nxt-detail-item">
                                <span class="nxt-detail-label">저가</span>
                                <span id="nxtLow" class="nxt-detail-value">0</span>
                            </div>
                            <div class="nxt-detail-item">
                                <span class="nxt-detail-label">거래량</span>
                                <span id="nxtVolume" class="nxt-detail-value">0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Moving Averages Card -->
                <div class="ma-card">
                    <h3 class="ma-title">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                        </svg>
                        이동평균선 (Moving Averages)
                    </h3>
                    <div class="ma-grid">
                        <div class="ma-item" id="ma5Card">
                            <div class="ma-period">
                                <span class="ma-dot ma-dot-5"></span>
                                5일선
                            </div>
                            <div id="ma5Value" class="ma-value">-</div>
                            <div id="ma5Diff" class="ma-diff">-</div>
                        </div>
                        <div class="ma-item" id="ma10Card">
                            <div class="ma-period">
                                <span class="ma-dot ma-dot-10"></span>
                                10일선
                            </div>
                            <div id="ma10Value" class="ma-value">-</div>
                            <div id="ma10Diff" class="ma-diff">-</div>
                        </div>
                        <div class="ma-item" id="ma20Card">
                            <div class="ma-period">
                                <span class="ma-dot ma-dot-20"></span>
                                20일선
                            </div>
                            <div id="ma20Value" class="ma-value">-</div>
                            <div id="ma20Diff" class="ma-diff">-</div>
                        </div>
                        <div class="ma-item" id="ma60Card">
                            <div class="ma-period">
                                <span class="ma-dot ma-dot-60"></span>
                                60일선
                            </div>
                            <div id="ma60Value" class="ma-value">-</div>
                            <div id="ma60Diff" class="ma-diff">-</div>
                        </div>
                    </div>
                </div>

                <!-- MA Visual Bar -->
                <div class="ma-visual-card">
                    <h3 class="ma-title">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M3 3v18h18"></path>
                            <path d="m19 9-5 5-4-4-3 3"></path>
                        </svg>
                        이동평균 대비 현재가 위치
                    </h3>
                    <div id="maVisualBars" class="ma-visual-bars"></div>
                    <div class="ma-visual-legend">
                        <span class="ma-visual-legend-line"></span>
                        세로선은 <strong>현재가</strong>를 의미합니다.
                    </div>
                </div>

                <!-- AI Candle Pattern Analysis Report -->
                <div id="analysisSection" class="analysis-section hidden">
                    <!-- Analysis Header -->
                    <div class="analysis-header-card">
                        <h3 class="analysis-title">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path
                                    d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83" />
                            </svg>
                            AI 캔들 패턴 분석 리포트
                        </h3>
                        <div class="analysis-loading hidden" id="analysisLoading">
                            <div class="spinner spinner-sm"></div>
                            <span>패턴 분석 중...</span>
                        </div>

                        <!-- Trend Badge -->
                        <div class="trend-container" id="trendContainer">
                            <div id="trendBadge" class="trend-badge">
                                <span id="trendIcon" class="trend-icon"></span>
                                <span id="trendLabel" class="trend-label"></span>
                            </div>
                            <div class="trend-strength-bar">
                                <div id="trendStrengthFill" class="trend-strength-fill"></div>
                            </div>
                            <span id="trendStrengthText" class="trend-strength-text"></span>
                        </div>
                    </div>

                    <!-- Detected Patterns -->
                    <div class="patterns-card" id="patternsCard">
                        <h4 class="card-subtitle">
                            <i class="ph ph-chart-bar" style="margin-right: 6px;"></i> 감지된 캔들 패턴
                        </h4>
                        <div id="patternsList" class="patterns-list"></div>
                        <div id="noPatternsMsg" class="no-patterns hidden">
                            현재 뚜렷한 캔들 패턴이 감지되지 않았습니다.
                        </div>
                    </div>

                    <!-- Candlestick Mini Chart -->
                    <div class="candle-chart-card" id="candleChartCard">
                        <h4 class="card-subtitle" id="chartTitle">
                            <i class="ph ph-chart-line-up" style="margin-right: 6px;"></i> 최근 3개월 간 캔들 차트
                        </h4>
                        <div id="candleChart" class="candle-chart"></div>

                        <!-- Recent Week Analysis -->
                        <div id="recentWeekAnalysis" class="recent-week-analysis hidden"
                            style="margin-top: 20px; padding-top: 16px; border-top: 1px solid var(--border-color);">
                            <h5
                                style="font-size: 0.95rem; color: var(--text-color); margin-bottom: 12px; display: flex; align-items: center; gap: 6px;">
                                <i class="ph ph-calendar-check" style="color: var(--primary);"></i> 최근 1주일 캔들 상세 분석
                            </h5>
                            <ul id="recentWeekList"
                                style="list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 8px;">
                                <!-- JS injected -->
                            </ul>
                        </div>
                    </div>

                    <!-- Buy / Sell Reports Grid -->
                    <div class="report-grid" id="reportGrid">
                        <!-- Buy Report -->
                        <div id="buyReport" class="report-card report-buy hidden">
                            <div class="report-header report-header-buy">
                                <span class="report-icon"><i class="ph ph-trend-up"></i></span>
                                <span class="report-title">매수 리포트</span>
                                <span id="buySignalBadge" class="signal-badge signal-buy"></span>
                            </div>
                            <div class="report-body">
                                <div class="report-pattern" id="buyPattern"></div>
                                <div class="report-desc" id="buyDesc"
                                    style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; line-height: 1.4;">
                                </div>
                                <div class="report-prices">
                                    <div class="price-row-item">
                                        <span class="price-label">적극 매수가</span>
                                        <span id="buyAggressive" class="price-val buy-color"></span>
                                    </div>
                                    <div class="price-row-item">
                                        <span class="price-label">보수 매수가</span>
                                        <span id="buyConservative" class="price-val buy-color"></span>
                                    </div>
                                    <div class="price-row-item">
                                        <span class="price-label">목표가</span>
                                        <span id="buyTarget" class="price-val target-color"></span>
                                    </div>
                                    <div class="price-row-item stop-loss">
                                        <span class="price-label">손절가</span>
                                        <span id="buyStopLoss" class="price-val sell-color"></span>
                                    </div>
                                </div>
                                <div class="report-meta">
                                    <div id="buyRiskReward" class="risk-reward"></div>
                                    <div id="buyVolume" class="volume-note"></div>
                                </div>
                                <div id="buyTip" class="report-tip"></div>
                            </div>
                        </div>

                        <!-- Sell Report -->
                        <div id="sellReport" class="report-card report-sell hidden">
                            <div class="report-header report-header-sell">
                                <span class="report-icon"><i class="ph ph-trend-down"></i></span>
                                <span class="report-title">매도 리포트</span>
                                <span id="sellSignalBadge" class="signal-badge signal-sell"></span>
                            </div>
                            <div class="report-body">
                                <div class="report-pattern" id="sellPattern"></div>
                                <div class="report-desc" id="sellDesc"
                                    style="font-size: 0.85rem; color: var(--text-muted); margin-bottom: 12px; line-height: 1.4;">
                                </div>
                                <div class="report-prices">
                                    <div class="price-row-item">
                                        <span class="price-label">즉시 매도가</span>
                                        <span id="sellPrice" class="price-val sell-color"></span>
                                    </div>
                                    <div class="price-row-item">
                                        <span class="price-label">보수 매도가</span>
                                        <span id="sellConservative" class="price-val sell-color"></span>
                                    </div>
                                    <div class="price-row-item">
                                        <span class="price-label">예상 하락가</span>
                                        <span id="sellTarget" class="price-val target-color"></span>
                                    </div>
                                    <div class="price-row-item stop-loss">
                                        <span class="price-label">최대 손절가</span>
                                        <span id="sellStopLoss" class="price-val buy-color"></span>
                                    </div>
                                </div>
                                <div class="report-meta">
                                    <div id="sellRiskReward" class="risk-reward"></div>
                                    <div id="sellVolume" class="volume-note"></div>
                                </div>
                                <div id="sellTip" class="report-tip"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Disclaimer -->
                    <div class="disclaimer">
                        ⚠️ 본 분석은 캔들 패턴을 기반으로 한 기술적 참고자료이며, 투자 판단의 최종 결정은 본인에게 있습니다.
                    </div>
                </div>
            </section>
        </div>
    </div> <!-- .app-layout -->

    <!-- Vertical Theme Switch (Bottom Right) -->
    <div class="vertical-theme-switch-wrapper">
        <i class="ph ph-sun theme-icon-sun"></i>
        <button id="themeToggle" class="theme-switch-btn vertical-switch" aria-label="테마 변경" title="다크/라이트 모드 전환">
            <span class="theme-switch-thumb"></span>
        </button>
        <i class="ph ph-moon theme-icon-moon"></i>
    </div>

    <!-- Auth Modal Overlay -->
    <div id="authModalOverlay" class="modal-overlay"></div>
    <!-- Auth Modal -->
    <div id="authModal" class="auth-modal">
        <div class="modal-header">
            <h3 id="authModalTitle">로그인</h3>
            <button id="closeAuthModal" class="close-modal-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg>
            </button>
        </div>

        <div class="modal-body">
            <div id="authErrorMsg" class="auth-error-msg"></div>

            <button id="googleAuthBtn" class="google-auth-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"
                        fill="#4285F4" />
                    <path
                        d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"
                        fill="#34A853" />
                    <path
                        d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"
                        fill="#FBBC05" />
                    <path
                        d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"
                        fill="#EA4335" />
                </svg>
                Continue with Google
            </button>

            <div class="divider">
                <span>또는</span>
            </div>

            <form id="authForm" class="auth-form">
                <div class="form-group">
                    <label for="username">아이디</label>
                    <input type="text" id="username" name="username" placeholder="아이디를 입력하세요" required
                        autocomplete="username">
                </div>

                <div class="form-group">
                    <label for="password">비밀번호</label>
                    <input type="password" id="password" name="password" placeholder="비밀번호를 입력하세요" required
                        autocomplete="current-password">
                </div>

                <button type="submit" id="authSubmitBtn" class="primary-btn">로그인</button>
            </form>

            <div class="auth-switch">
                <span id="authSwitchText">아직 계정이 없으신가요?</span>
                <button class="text-btn" id="authSwitchBtn">회원가입</button>
            </div>
        </div>
    </div>

    <!-- OAuth Confirm Modal Overlay -->
    <div id="oauthConfirmOverlay" class="modal-overlay"></div>
    <!-- OAuth Confirm Modal -->
    <div id="oauthConfirmModal" class="confirm-modal">
        <div class="confirm-modal-body">
            <h3 class="confirm-title">"오늘의 주식" Wants to Use "google.com" to Sign In</h3>
            <p class="confirm-desc">This allows the app and website to share information about you.</p>

            <div class="confirm-actions">
                <button id="oauthCancelBtn" class="confirm-btn-secondary">Cancel</button>
                <button id="oauthContinueBtn" class="confirm-btn-primary">Continue</button>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>

</html>